-- T·∫°o ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = game.CoreGui

-- T·∫°o Frame
local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 100, 0, 50) -- Gi·∫£m 50%
Frame.Position = UDim2.new(0.5, -50, 0.5, -25)
Frame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
Frame.BorderSizePixel = 2
Frame.Draggable = true
Frame.Active = true
Frame.Parent = ScreenGui

-- T·∫°o Toggle Button
local ToggleButton = Instance.new("TextButton")
ToggleButton.Size = UDim2.new(0, 90, 0, 25) -- Gi·∫£m 50%
ToggleButton.Position = UDim2.new(0, 5, 0, 12)
ToggleButton.Text = "Loading..."
ToggleButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
ToggleButton.Parent = Frame

-- ƒê·ªçc tr·∫°ng th√°i t·ª´ file
local filename = "autodungeon_toggle.txt"
local enabled = false
if pcall(function() readfile(filename) end) then
    enabled = readfile(filename) == "true"
end

-- H√†m l∆∞u tr·∫°ng th√°i
local function saveState(state)
    writefile(filename, tostring(state))
end

-- C·∫≠p nh·∫≠t tr·∫°ng th√°i ban ƒë·∫ßu
ToggleButton.Text = enabled and "Auto Dungeon: ON" or "Auto Dungeon: OFF"

-- H√†m b·∫≠t/t·∫Øt t√≠nh nƒÉng
ToggleButton.MouseButton1Click:Connect(function()
    enabled = not enabled
    saveState(enabled)
    ToggleButton.Text = enabled and "Auto Dungeon: ON" or "Auto Dungeon: OFF"
    
    wait(1)

    if enabled then
        -- üîÅ Ch·∫°y 2 t√≠nh nƒÉng song song khi b·∫≠t
        task.spawn(function()
            loadstring(game:HttpGet('https://raw.githubusercontent.com/Baylac2006/avatar-fighting/refs/heads/main/autodungeon'))()
        end)

        task.spawn(function()
            loadstring(game:HttpGet('https://raw.githubusercontent.com/Baylac2006/avatar-fighting/refs/heads/main/automob'))()
        end)
    end
end)

-- üöÄ T·ª± ch·∫°y n·∫øu ON khi kh·ªüi ƒë·ªông
if enabled then
    wait(1)
    task.spawn(function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/Baylac2006/avatar-fighting/refs/heads/main/autodungeon'))()
    end)

    task.spawn(function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/Baylac2006/avatar-fighting/refs/heads/main/automob'))()
    end)
end
